<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/Yipan_Song-login.css" >
    <script src="/index.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link href="css/bootstrap.css" rel="stylesheet">
    <!--    <link rel="stylesheet" href="/stylesheet.css">-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
            src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous">
    </script>
<!--    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.6.0/umd/popper.min.js"></script>-->
</head>
<body >
<nav class="navbar navbar-expand-sm navbar-light fixed-top" style="background-color: lavender; height:56px">
    <a class="navbar-brand" href="/community"  style="margin-left: 30px">
        <img src="/images/dog.jpg" alt="Logo" style="width:40px;">
    </a>
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="/">Homepage</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="/community">Community</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/upload">Post</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/myprofile">My profile</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/logout">Log out</a>
            </li>
        </ul>
    <a class="navbar-brand" href="/community"  style="margin-left: 30px">
        <img src="/images/dog.jpg" alt="Logo" style="width:40px;">
    </a>
</nav>
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-3" ></div>
        <div class="col-lg-5" style="margin-top:100px;">
        <%for (var i = 0; i < content.length ; i++) { %>
        <div class="card" style="width:680px;background-color: lavender">
            <h4  class="card-title" style="margin-left:15px; margin-top:10px">
                <%for (var u in users){%>
                <%if (users[u].username == content[i].username){%>
                <a href="/profile/<%=content[i].username%>"><img src="/uploads/<%= users[u].userphoto %>" alt="photo" style="width:60px; border-radius: 50px;"></a>
                <%}%>
                <%}%>
                &nbsp;&nbsp;<a href="/profile/<%=content[i].username%>" style="text-decoration:none;"><span id="cardname" ><%=content[i].username%></span></a><br/></h4>
            <p class="card-text" style="margin-left:15px"><%=content[i].place%></p>
            <% if(content[i].checkImages == 1){ %>
                <% var imageArr = (content[i].image).split(","); %>
            <div id="carouselExampleIndicators_<%=i%>" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                <% for (var z = 0; z < imageArr.length ; z++) { %>
                <%if (z == 0){%>
                        <li data-target="#carouselExampleIndicators_<%=i%>" data-slide-to="0" class="active"></li>
                <%}else {%>
                        <li data-target="#carouselExampleIndicators_<%=i%>" data-slide-to="<%=z%>"></li>
                <%}%>
                <%}%>
                </ol>
                <div class="carousel-inner">
                  <% for (var j = 0; j < imageArr.length ; j++) { %>
                        <%if (j == 0){%>
                    <div class="carousel-item active">
                        <a href="/images/<%=content[i].id%>"><img class="d-block w-100 card-img-top" src="/uploads/<%=imageArr[j]%>" alt= "slide_<%=j%>" style="width:100%;height:659px;border: 2px solid;"/></a>
                        <div class="carousel-caption d-none d-md-block">
                            <h5><%= eval("j+1")%>/<%=imageArr.length%></h5>
                            <p style="color:white">Click the arrow to flip</p>
                        </div>
                    </div>
                            <%}else {%>
                            <div class="carousel-item">
                                <a href="/images/<%=content[i].id%>"><img class="d-block w-100 card-img-top" src="/uploads/<%=imageArr[j]%>" alt="slide_<%=j%>" style="width:100%;height:659px; border: 2px solid;"/></a>
                                <div class="carousel-caption d-none d-md-block">
                                    <h5><%= eval("j+1")%>/<%=imageArr.length%></h5>
                                    <p style="color:white">Click the arrow to flip</p>
                                </div>
                            </div>
                            <%}%>
                <%}%>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators_<%=i%>" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators_<%=i%>" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <%} else {%>
            <a href="/images/<%=content[i].id%>"><img class="card-img-top"  src="/uploads/<%=content[i].image%>" alt="Card image" style="width:100%;height:659px;border: 2px solid;"></a>
            <%}%>
            <div class="card-body">
                <div id="time"></div>
                <p class="card-text"><%=content[i].time%>
            </p>
                <p class="card-text"><div style="font-weight: bold">Caption:</div><%=content[i].caption%></p>
                <p class="card-text">likes
                    <% var check = false; %>
                    <% if (checklikes.length == 0){ %>
                    <img id="like_<%=content[i].id%>" onclick="like(<%=content[i].id%>)" src="images/like.png" alt="like" style="width:40px;">
                    <%} else {%>
                    <% for (var q in checklikes){ %>
                   <% if(checklikes[q].imageid == (content[i].id + 1))  { %>
                      <% check = true;%>
                    <% }%>
                   <% } %>
                   <% if (check){ %>
                    <img id="like_<%=content[i].id%>" onclick="like(<%=content[i].id%>)" src="images/heart.png" alt="like" style="width:40px;">
                   <% } else { %>
                    <img id="like_<%=content[i].id%>" onclick="like(<%=content[i].id%>)" src="images/like.png" alt="like" style="width:40px;">
                  <%   } %>
                    <%}%>
                    <span id="like_num_<%=content[i].id%>%>"><%=content[i].likes%></span></p>
<!--                <div class="card-text">-->
                    <div style="font-weight: bold">Comments:</div>
                    <%for(var n in comments) {%>
                   <% if (comments[n].imageid == (content[i].id + 1)){%>
                <p><%=comments[n].username%>: <%=comments[n].content%></p>
                    <%}%>
                <%}%>
                        <div id="comments_<%=content[i].id%>"></div>
<!--                </div>-->
                <textarea class="form-control" rows="5" id="comments__<%=content[i].id%>" name="comments"></textarea><br/>
                <button  id="comments" class="btn btn-warning" type="button" onclick= "sub(<%=content[i].id%>)">Submit Comment</button>
            </div>
        </div>
            <br/>
        <%}%>
    </div>
        <div class="col-lg-4">
            <div style="position: fixed;top:99px">
                    <div class="card" style="border-radius: 30px;background-color: lavender">
                        <a href="/myprofile" style="text-decoration: none;color:black" ><h4 id="cardname" style="text-align: center;"><%=username%><br/>
                                <% for(var q in users) {%>
                                    <% if(users[q].username == username){%>
                                       <%=users[q].firstname%> <%=users[q].surname%>
                                    <%}%>
                                <%}%>

                            </h4>
                            </a>
                        <div class="card-body">
                        <% for(var q in users) {%>
                            <% if(users[q].username == username){%>
                            <a href="/myprofile" ><img  src="/uploads/<%=users[q].userphoto%>" alt="user image" style="height:200px;width:200px;border:solid;border-radius:150px;border-color:yellow;"/></a>
                            <%}%>
                        <%}%>
                </div>
            </div>
    </div>
    </div>
</div>

</div>
</body>
</html>