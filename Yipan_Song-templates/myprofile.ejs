<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/Yipan_Song-login.css" >
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link href="css/bootstrap.css" rel="stylesheet">
    <!--    <link rel="stylesheet" href="/stylesheet.css">-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
            src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous">
    </script>

    <script src="/index.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-sm navbar-light fixed-top" style="background-color: lavender; height:56px">
    <a class="navbar-brand" href="/community"  style="margin-left: 30px">
        <img src="/images/dog.jpg" alt="Logo" style="width:40px;">
    </a>
    <ul class="navbar-nav">
        <li class="nav-item active">
            <a class="nav-link" href="/">Homepage</a>
        </li>
        <li class="nav-item active">
            <a class="nav-link" href="/community">Community</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/upload">Post</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/myprofile">My profile</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/logout">Log out</a>
        </li>
    </ul>
    <a class="navbar-brand" href="/community"  style="margin-left: 30px">
        <img src="/images/dog.jpg" alt="Logo" style="width:40px;">
    </a>
</nav>
<div class="container-fluid" style="margin-top:150px;">
    <div class="row">
        <div class="col-lg-3" ></div>
        <div class="col-lg-2" >
        <img class="card-img-top" src="/uploads/<%=users[0].userphoto%>" alt="Card image" style="width:200px;height:200px;border-radius:10px;margin: auto"><br/><br/>
    </div>
                <div class="col-lg-2" >
            <h4 class="card-title" style="color: lavender"><%=users[0].firstname%>&nbsp;<%=users[0].surname%></h4>
            <h5 class="card-title" style="color: lavender"><%=users[0].username%></h5>
                    <a href="/changephoto" style="text-decoration: none"><button class="btn btn-warning">Change my profile photo</button></a><br/><br/>
                    <a href="/password" style="text-decoration: none"><button class="btn btn-warning">Change my password</button></a><br/><br/>
                    <a href="/edit" style="text-decoration: none"><button class="btn btn-warning">Edit my profile</button></a>
                </div>
                    <div class="col-lg-4" >
                        <h5><span class="text-warning">Phone Number:</span><span style="color: lavender">&nbsp;&nbsp;<%=users[0].phone%></span></h5>
                        <h5><span class="text-warning">Email:</span><span style="color: lavender"> &nbsp;&nbsp;<%=users[0].email%></span></h5>
                        <h5><span class="text-warning">Bio:</span><span style="color: lavender">&nbsp;&nbsp;<%=users[0].bio%></span></h5>
                    </div>

    </div>
</div>
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-3" ></div>
        <div class="col-lg-9" style="margin-top:100px;">
            <h2 style="color: lavender;">My posts</h2>
            <%for (var i = 0; i < content.length ; i++) { %>
            <div class="card" style="width:680px;background-color: lavender">
                <p class="card-text" style="margin-left:15px"><%=content[i].place%></p>
                <% if(content[i].checkImages == 1){ %>
                    <% var imageArr = (content[i].image).split(","); %>
                    <div id="carouselExampleIndicators_<%=i%>" class="carousel slide" data-ride="carousel">
                        <ol class="carousel-indicators">
                            <% for (var z = 0; z < imageArr.length ; z++) { %>
                            <%if (z == 0){%>
                            <li data-target="#carouselExampleIndicators_<%=i%>" data-slide-to="0" class="active"></li>
                            <%}else {%>
                            <li data-target="#carouselExampleIndicators_<%=i%>" data-slide-to="<%=z%>"></li>
                            <%}%>
                            <%}%>
                        </ol>
                        <div class="carousel-inner">
                            <% for (var j = 0; j < imageArr.length ; j++) { %>
                            <%if (j == 0){%>
                            <div class="carousel-item active">
                              <img class="d-block w-100 card-img-top" src="/uploads/<%=imageArr[j]%>" alt= "slide_<%=j%>" style="width:100%;height:659px;border: 2px solid;"/>
                                <div class="carousel-caption d-none d-md-block">
                                    <h5><%= eval("j+1")%>/<%=imageArr.length%></h5>
                                    <p style="color:white">Click the arrow to flip</p>
                                </div>
                            </div>
                            <%}else {%>
                            <div class="carousel-item">
                                <img class="d-block w-100 card-img-top" src="/uploads/<%=imageArr[j]%>" alt="slide_<%=j%>" style="width:100%;height:659px; border: 2px solid;"/>
                                <div class="carousel-caption d-none d-md-block">
                                    <h5><%= eval("j+1")%>/<%=imageArr.length%></h5>
                                    <p style="color:white">Click the arrow to flip</p>
                                </div>
                            </div>
                            <%}%>
                            <%}%>
                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleIndicators_<%=i%>" role="button" data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleIndicators_<%=i%>" role="button" data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                <%} else {%>
               <img class="card-img-top"  src="/uploads/<%=content[i].image%>" alt="Card image" style="width:100%">
                <%}%>
                <div class="card-body">
                    <div id="time"></div>
                    <p  class="card-text"><%=content[i].time%>
                    </p>
                    </p>
                    <p class="card-text"><%=content[i].caption%></p>
                    <p class="card-text">likes
                        <% var check = false; %>
                        <% if (checklikes.length == 0){ %>
                        <img id="like_<%=content[i].id%>%>" onclick="like(<%=content[i].id%>)" src="images/like.png" alt="like" style="width:40px;">
                        <%} else {%>
                            <% for (var q in checklikes){ %>
                                <% if(checklikes[q].imageid == (content[i].id + 1))  { %>
                                    <% check = true;%>
                                <% }%>
                            <% } %>
                            <% if (check){ %>
                            <img id="like_<%=content[i].id%>" onclick="like(<%=content[i].id%>)" src="/images/heart.png" alt="like" style="width:40px;">
                            <% } else { %>
                            <img id="like_<%=content[i].id%>" onclick="like(<%=content[i].id%>)" src="/images/like.png" alt="like" style="width:40px;">
                            <%   } %>
                        <%}%>
                        <span id="like_num_<%=content[i].id%>"><%=content[i].likes%></span></p>
                    <!--                <div class="card-text">-->
                    <div style="font-weight: bold">Comments:</div>
                    <%for(var n in comments) {%>
                        <% if (comments[n].imageid == (content[i].id + 1)){%>
                        <p><%=comments[n].username%>: <%=comments[n].content%></p>
                        <%}%>
                    <%}%>
                    <div id="comments_<%=content[i].id%>%>"></div>
                    <!--                </div>-->
                    <textarea class="form-control" rows="5" id="comments__<%=content[i].id%>" name="comments"></textarea><br/>
                    <button  id="comments" class="btn btn-warning" type="button" onclick= "sub(<%=content[i].id%>)">Submit Comment</button>
                </div>
            </div><br/>
            <%}%>
            <!--    </div>-->
        </div>
    </div>
</div>
</div>
</body>
</html>